<script type="statebus">
dom.BODY = ->

  if (@loading)
    "Loading..."

  DIV
    style:
      textAlign: 'left'
      padding: '20px'
      marginBottom: '50px'
      font: "18px 'Muli', sans-serif"

    DIV
      style:
        fontWeight: 'bold'
        fontSize: '1.5em'
      'Hacker Hours'

    DIV
      style:
        color: "#B7B8BF"
      'Free programming help in Seattle and online, any language, any skill level.'

    events_list = fetch("website/events")
    members_list = fetch("website/members")

    if not events_list.list?
        events_list.list = []
        save(events_list)
    if not members_list.list?
        members_list.list = []
        save(members_list)

    DIV
      style:
        margin: "10px"
        float: "clear"
      events_list.list.map (entry) ->
        if not entry.key?
          console.log("No entry key!")
        if not entry.name?
          console.log("No entry name")

        DIV 
          className: "eventBanner"
          id: entry.name + entry.num
          entry.name + entry.num

    DIV
      className: "eventBanner"
      "Hacker Hours 38"

      DIV
        style:
          fontSize: '0.75em'
          fontStyle: "italic"
        "Wednesday, 1 June 2016, 18:30 - 20:30 PDT"


    DIV
      className: "eventBanner"
      style:
        fontSize: '2em'
      "Hacker Hours 37"

      DIV
        style:
          fontSize: '0.75em'
          fontStyle: "italic"
        "Wednesday, 18 May 2016, 18:30 - 20:30 PDT"

      DIV
        style: null
        DIV
          style:
            fontSize: '0.5em'
          "Michelle Lawson"
        A
          href: "http://codemonkeyatplay.github.io/"
          IMG
            src: "http://codemonkeyatplay.github.io/MichelleLawson.jpg"
            width: "100px"
            height: "100px"

      DIV
        style: null
        DIV
          style:
            fontSize: '0.5em'
          "Paul Pham"
        A
          href: "/community/paulpham.html"
          IMG
            src: "https://pbs.twimg.com/profile_images/682448363447398401/5UP_8t0Y.png"
            width: "100px"
            height: "100px"
	
    # Function to generate an entry form
    # tip: thing-in-progress, the object to build and save
    # entries: a list of objects of the form
    #   {key, name} where
    #     key is a string representing entry key which are also used in the div IDs
    #     name is the display name
    # name: string name for the thing to add
    entry_form = (tip, entries, name, listobj) ->
        DIV
            style:
                margin: "10px"
                float: "clear"
            entries.map (entry) ->
                if not entry.key?
                    console.log("No entry key!")
                if not entry.name?
                    console.log("No entry name")

                INPUT
                    type: 'text'
                    id: 'new_'+entry.key
                    # Construct the placeholder from the
                    # previous value-in-progress, or construct
                    # the name from the thing-in-progress + entry key
                    placeholder: (tip and tip[entry.key]) or name + " " + entry.name
                    onChange: (e) =>
                        tip[entry.key] = e.target.value;
                        save(tip);
            BUTTON
                id: 'submit'
                onClick: (e) =>
                    if not listobj.list?
                        listobj.list = []
                        listobj.lastId = 1
                    console.log("tip= " + JSON.stringify(tip))
                    listobj.list.push(tip)
                    listobj.lastId = listobj.lastId + 1
                    del(tip)
                    save(listobj)
                "Add "+name

    # Members
    mip_entries = [
        {key: "name", name: "Name"},
        {key: "project", name: "Project"}
        {key: "event", name: "Event Name & Number"}
    ]
    mip = fetch("ls/mip") # member-in-progress
    entry_form(mip, mip_entries, "Invisible", members_list)

    # Entries
    eip_entries = [
        {key: "name", name: "Name"},
        {key: "date", name: "Date"},
        {key: "num", name: "Number"}
    ]
    eip = fetch("ls/eip") # event-in-progress
    entry_form(eip, eip_entries, "Event", events_list)
    
</script>

<!DOCTYPE html>
<html lang="en">

<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="http://invisible.college/favicon.ico">

  <title>Invisible College</title>

  <!-- Bootstrap core CSS -->
  <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts from femmebot.github.io/google-type -->

  <!-- Google web fonts for "The Astronomer" -->
  <link href='https://fonts.googleapis.com/css?family=Megrim|Roboto+Slab:300' rel='stylesheet' type='text/css'>

  <!-- Google web fonts for "The River" -->
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:800|Gentium+Basic:400,400italic' rel='stylesheet' type='text/css'>

  <link href='https://fonts.googleapis.com/css?family=Ovo|Muli:300' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="/css/cover.css" rel="stylesheet">
  <!--<link href="css/google-type.css" rel="stylesheet">-->

</head>

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

<!-- Statebus 3 code -->
  <script type="text/javascript">
  // Global symbols needed by router below

  var statebus_version = 3;
  // My AWS instance
  var aws_ip='http://52.32.161.104';
  var statebus_server = aws_ip+':45678';

  var email_url = aws_ip+'/email';
  $("form#signup").attr("action", email_url);
  var pay_url = aws_ip+'/stripe';
  $("form#stripe").attr("action", pay_url);

  /*
  var scr = document.createElement('script');
  $("form#stripe").append(scr);

  var ss = $("form#stripe script");
  ss.attr("id", "stripe-button");
  ss.attr("src", "https://checkout.stripe.com/checkout.js");
  ss.attr("class", "stripe-button");
  ss.attr("data-key", "pk_live_rigI562smH2C3dHSDdn257qv");
  ss.attr("data-amount", "25000");
  ss.attr("data-name", "Invisible College Android Class 1");
  ss.attr("data-description", "8 sessions ($250.00)");
  ss.attr("data-image", "/128x128.png");
  ss.attr("data-locale", "auto");
  */

  //var statebus_server = aws_ip+':45678';

  var statebus_server = 'https://stateb.us:3003'
  //var statebus_server = 'http://localhost:45678'
  </script>
  <!-- <script src="js/util.js"></script> -->
  <!-- route first to set the view, then parse statebus -->
  <script src="https://stateb.us/client.js"></script>

</body>
</html>
